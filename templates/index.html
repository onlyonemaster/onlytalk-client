<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¹´ì¹´ì˜¤í†¡ ì¹œêµ¬ ìë™ ì¶”ê°€ ëŒ€ì‹œë³´ë“œ</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            padding: 20px;
        }
        .dashboard-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .card {
            border: none;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .card-header {
            background-color: #667eea;
            color: white;
            border-radius: 10px 10px 0 0 !important;
            font-weight: bold;
        }
        .log-container {
            background-color: #1e1e1e;
            color: #d4d4d4;
            padding: 15px;
            border-radius: 5px;
            height: 300px;
            overflow-y: auto;
            font-family: 'Consolas', monospace;
            font-size: 13px;
        }
        .log-entry {
            margin-bottom: 5px;
        }
        .log-time {
            color: #858585;
            margin-right: 10px;
        }
        .progress {
            height: 30px;
            font-size: 14px;
        }
        .btn-start {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            padding: 12px 30px;
            font-size: 16px;
        }
        .btn-stop {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border: none;
            padding: 12px 30px;
            font-size: 16px;
        }
        .friend-table {
            max-height: 400px;
            overflow-y: auto;
        }
        .status-badge {
            font-size: 14px;
            padding: 8px 15px;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <!-- í—¤ë” -->
        <div class="dashboard-header">
            <div class="d-flex justify-content-between align-items-start">
                <div>
                    <h1>ğŸ¯ ì¹´ì¹´ì˜¤í†¡ ì¹œêµ¬ ìë™ ì¶”ê°€ ëŒ€ì‹œë³´ë“œ</h1>
                    <p class="mb-0">êµ¬ê¸€ ì‹œíŠ¸ ë°ì´í„°ë¥¼ ì½ì–´ì„œ ìë™ìœ¼ë¡œ ì¹œêµ¬ë¥¼ ì¶”ê°€í•˜ê³  ë©”ì‹œì§€ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤</p>
                </div>
                <button class="btn btn-light btn-lg" onclick="showManual()" style="white-space: nowrap;">
                    ğŸ“– ì´ìš© ë§¤ë‰´ì–¼
                </button>
            </div>
        </div>

        <div class="row">
            <!-- ì™¼ìª½: ì„¤ì • ë° ì»¨íŠ¸ë¡¤ -->
            <div class="col-md-6">
                <!-- êµ¬ê¸€ ì‹œíŠ¸ ì„¤ì • -->
                <div class="card">
                    <div class="card-header">
                        ğŸ“Š êµ¬ê¸€ ì‹œíŠ¸ ì„¤ì •
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label fw-bold">êµ¬ê¸€ ì‹œíŠ¸ URL</label>
                            <div class="input-group">
                                <input type="text" class="form-control" id="sheetUrl"
                                       placeholder="https://docs.google.com/spreadsheets/d/...">
                                <button class="btn btn-primary" onclick="updateSheetUrl()">
                                    ğŸ”„ ì ìš©
                                </button>
                            </div>
                            <small class="text-muted">
                                êµ¬ê¸€ ì‹œíŠ¸ URLì„ ì…ë ¥í•˜ë©´ ì‹¤ì‹œê°„ìœ¼ë¡œ ìµœì‹  ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤
                            </small>
                        </div>
                        <div class="d-grid">
                            <button class="btn btn-outline-primary btn-sm" onclick="refreshFriends()">
                                ğŸ”ƒ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ì¹œêµ¬ ëª©ë¡ -->
                <div class="card">
                    <div class="card-header">
                        ğŸ“‹ ì¹œêµ¬ ëª©ë¡
                    </div>
                    <div class="card-body">
                        <div class="friend-table">
                            <table class="table table-sm table-hover">
                                <thead>
                                    <tr>
                                        <th>ë²ˆí˜¸</th>
                                        <th>ì´ë¦„</th>
                                        <th>ì „í™”ë²ˆí˜¸</th>
                                        <th>ë©”ì‹œì§€</th>
                                    </tr>
                                </thead>
                                <tbody id="friendList">
                                    <tr>
                                        <td colspan="4" class="text-center">ë¡œë”© ì¤‘...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="text-end mt-2">
                            <span class="badge bg-primary status-badge" id="totalFriends">ì´ 0ëª…</span>
                        </div>
                    </div>
                </div>

                <!-- ì„¤ì • -->
                <div class="card">
                    <div class="card-header">
                        âš™ï¸ ì„¤ì •
                    </div>
                    <div class="card-body">
                        <!-- ë²”ìœ„ ì„¤ì • -->
                        <div class="mb-3">
                            <label class="form-label fw-bold">ğŸ“ ë²”ìœ„ ì„¤ì •</label>
                            <div class="row">
                                <div class="col-6">
                                    <input type="number" class="form-control" id="startNum" placeholder="ì‹œì‘ ë²ˆí˜¸" value="1" min="1">
                                </div>
                                <div class="col-6">
                                    <input type="number" class="form-control" id="endNum" placeholder="ë ë²ˆí˜¸" value="1" min="1">
                                </div>
                            </div>
                            <small class="text-muted">ì˜ˆ: ì‹œì‘=5, ë=10 â†’ 5ë²ˆë¶€í„° 10ë²ˆê¹Œì§€</small>
                        </div>

                        <!-- ëœë¤ ë”œë ˆì´ -->
                        <div class="mb-3">
                            <label class="form-label fw-bold">â° ëœë¤ ë”œë ˆì´ (ì´ˆ)</label>
                            <div class="row">
                                <div class="col-6">
                                    <input type="number" class="form-control" id="delayMin" placeholder="ìµœì†Œ" value="5" min="0" step="0.5">
                                </div>
                                <div class="col-6">
                                    <input type="number" class="form-control" id="delayMax" placeholder="ìµœëŒ€" value="30" min="0" step="0.5">
                                </div>
                            </div>
                            <small class="text-muted">ê° ì¹œêµ¬ ì²˜ë¦¬ í›„ ëŒ€ê¸° ì‹œê°„ (ìµœì†Œ~ìµœëŒ€ ë²”ìœ„ì—ì„œ ëœë¤)</small>
                        </div>

                        <!-- ì‹œì‘/ì¤‘ë‹¨ ë²„íŠ¼ -->
                        <div class="d-grid gap-2">
                            <button class="btn btn-primary btn-start" id="startBtn" onclick="startTask()">
                                ğŸš€ ì‹œì‘í•˜ê¸°
                            </button>
                            <button class="btn btn-danger btn-stop" id="stopBtn" onclick="stopTask()" style="display:none;">
                                â¹ï¸ ì¤‘ë‹¨í•˜ê¸°
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ì˜¤ë¥¸ìª½: ì§„í–‰ ìƒí™© ë° ë¡œê·¸ -->
            <div class="col-md-6">
                <!-- ì§„í–‰ ìƒí™© -->
                <div class="card">
                    <div class="card-header">
                        ğŸ“Š ì§„í–‰ ìƒí™©
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <div class="d-flex justify-content-between mb-2">
                                <span id="progressText">ëŒ€ê¸° ì¤‘...</span>
                                <span id="progressPercent">0%</span>
                            </div>
                            <div class="progress">
                                <div class="progress-bar progress-bar-striped progress-bar-animated"
                                     id="progressBar"
                                     role="progressbar"
                                     style="width: 0%">
                                </div>
                            </div>
                        </div>

                        <div class="row text-center mt-4">
                            <div class="col-4">
                                <div class="card bg-light">
                                    <div class="card-body">
                                        <h3 class="text-success mb-0" id="successCount">0</h3>
                                        <small class="text-muted">ì„±ê³µ</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="card bg-light">
                                    <div class="card-body">
                                        <h3 class="text-danger mb-0" id="failCount">0</h3>
                                        <small class="text-muted">ì‹¤íŒ¨</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="card bg-light">
                                    <div class="card-body">
                                        <h3 class="text-primary mb-0" id="totalCount">0</h3>
                                        <small class="text-muted">ì „ì²´</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ë¡œê·¸ -->
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <span>ğŸ“ ì‹¤ì‹œê°„ ë¡œê·¸</span>
                        <button class="btn btn-sm btn-outline-light" onclick="clearLogs()">ì§€ìš°ê¸°</button>
                    </div>
                    <div class="card-body p-0">
                        <div class="log-container" id="logContainer">
                            <div class="text-muted">ë¡œê·¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ì´ìš© ë§¤ë‰´ì–¼ ëª¨ë‹¬ -->
    <div class="modal fade" id="manualModal" tabindex="-1" aria-labelledby="manualModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                    <h5 class="modal-title" id="manualModalLabel">ğŸ“– ì¹´ì¹´ì˜¤í†¡ ì¹œêµ¬ ìë™ ì¶”ê°€ - ì´ìš© ë§¤ë‰´ì–¼</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" style="padding: 30px;">
                    <!-- ë§¤ë‰´ì–¼ ë‚´ìš© -->
                    <div class="manual-content">
                        <h2>ğŸ”¹ 1ë‹¨ê³„: ë…¸íŠ¸ë¶ ë¶€íŒ… ë° ì¤€ë¹„</h2>

                        <h4>1-1. ë…¸íŠ¸ë¶ ì¼œê¸°</h4>
                        <p>Windows ë¶€íŒ… ì™„ë£Œê¹Œì§€ ëŒ€ê¸°</p>

                        <h4>1-2. í•„ìˆ˜ ì‚¬í•­ í™•ì¸</h4>
                        <div class="alert alert-success">
                            <strong>âœ… ì¸í„°ë„· ì—°ê²° í™•ì¸</strong><br>
                            êµ¬ê¸€ ì‹œíŠ¸ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ê¸° ìœ„í•´ í•„ìš” (Wi-Fi ë˜ëŠ” ìœ ì„  ì—°ê²°)
                        </div>

                        <hr class="my-4">

                        <h2>ğŸ”¹ 2ë‹¨ê³„: ì¹´ì¹´ì˜¤í†¡ ì‹¤í–‰ ë° ë°°ì¹˜</h2>

                        <h4>2-1. ì¹´ì¹´ì˜¤í†¡ ì‹¤í–‰</h4>
                        <p>ë°”íƒ•í™”ë©´ ë˜ëŠ” ì‹œì‘ ë©”ë‰´ì—ì„œ <strong>ì¹´ì¹´ì˜¤í†¡</strong> ì‹¤í–‰ í›„ ë¡œê·¸ì¸ ì™„ë£Œ ëŒ€ê¸°</p>

                        <h4>2-2. ì¹´ì¹´ì˜¤í†¡ ì°½ ë°°ì¹˜ (âš ï¸ ì¤‘ìš”!)</h4>
                        <div class="alert alert-warning">
                            <ul>
                                <li>âœ… ì¹´ì¹´ì˜¤í†¡ ë©”ì¸ì°½ì„ í™”ë©´ ì¤‘ì•™ì— ë°°ì¹˜</li>
                                <li>âœ… ë‹¤ë¥¸ ì°½ì— ê°€ë ¤ì§€ì§€ ì•Šê²Œ í•˜ê¸°</li>
                                <li>âœ… ìµœì†Œí™”í•˜ì§€ ë§ê³  í™”ë©´ì— í‘œì‹œ</li>
                                <li>âœ… ì¹´í†¡ ì°½ í¬ê¸°ëŠ” ê¸°ë³¸ í¬ê¸° ìœ ì§€ (ë„ˆë¬´ ì‘ê±°ë‚˜ í¬ê²Œ í•˜ì§€ ë§ê¸°)</li>
                            </ul>
                            <strong>ì£¼ì˜:</strong> ì±„íŒ…ì°½ì´ ì•„ë‹Œ <strong>ë©”ì¸ ì¹œêµ¬ ëª©ë¡ ì°½</strong>ì´ì–´ì•¼ í•¨
                        </div>

                        <hr class="my-4">

                        <h2>ğŸ”¹ 3ë‹¨ê³„: ì„œë²„ ì‹¤í–‰</h2>

                        <h4>3-1. CMD(ëª…ë ¹ í”„ë¡¬í”„íŠ¸) ì—´ê¸°</h4>
                        <p><kbd>Windows í‚¤ + R</kbd> â†’ <code>cmd</code> ì…ë ¥ â†’ Enter</p>

                        <h4>3-2. í”„ë¡œì íŠ¸ í´ë”ë¡œ ì´ë™</h4>
                        <pre class="bg-dark text-light p-3 rounded"><code>cd D:\projects\claude</code></pre>

                        <h4>3-3. Flask ì„œë²„ ì‹¤í–‰</h4>
                        <pre class="bg-dark text-light p-3 rounded"><code>python app.py</code></pre>

                        <div class="alert alert-info">
                            <strong>âœ… ì„±ê³µ í™”ë©´:</strong><br>
                            <code>Running on http://127.0.0.1:5000</code> ë©”ì‹œì§€ê°€ í‘œì‹œë˜ë©´ ì„±ê³µ!
                        </div>

                        <hr class="my-4">

                        <h2>ğŸ”¹ 4ë‹¨ê³„: ë¸Œë¼ìš°ì €ì—ì„œ ëŒ€ì‹œë³´ë“œ ì ‘ì†</h2>

                        <p>ë¸Œë¼ìš°ì € ì£¼ì†Œì°½ì— ì…ë ¥:</p>
                        <pre class="bg-primary text-white p-3 rounded text-center"><code style="font-size: 18px;">http://localhost:5000</code></pre>

                        <hr class="my-4">

                        <h2>ğŸ”¹ 5ë‹¨ê³„: êµ¬ê¸€ ì‹œíŠ¸ ì„¤ì •</h2>

                        <h4>5-1. êµ¬ê¸€ ì‹œíŠ¸ ì¤€ë¹„</h4>
                        <table class="table table-bordered">
                            <thead class="table-light">
                                <tr>
                                    <th>Aì—´ (ì´ë¦„)</th>
                                    <th>Bì—´ (ì „í™”ë²ˆí˜¸)</th>
                                    <th>Cì—´ (ë©”ì‹œì§€)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ê¹€ì² ìˆ˜</td>
                                    <td>01012345678</td>
                                    <td>ì•ˆë…•í•˜ì„¸ìš”</td>
                                </tr>
                                <tr>
                                    <td>ì´ì˜í¬</td>
                                    <td>01087654321</td>
                                    <td>ë°˜ê°‘ìŠµë‹ˆë‹¤</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="alert alert-warning">
                            <strong>âš ï¸ ì£¼ì˜:</strong>
                            <ul class="mb-0">
                                <li>ì „í™”ë²ˆí˜¸ëŠ” <strong>í•˜ì´í”ˆ ì—†ì´</strong> (01012345678 âœ…, 010-1234-5678 âŒ)</li>
                                <li>ì²« ë²ˆì§¸ í–‰ë¶€í„° ë°ì´í„° ì…ë ¥ (í—¤ë” í–‰ ì—†ìŒ)</li>
                                <li>ë©”ì‹œì§€ëŠ” ì„ íƒì‚¬í•­ (ì—†ìœ¼ë©´ ì¹œêµ¬ë§Œ ì¶”ê°€)</li>
                            </ul>
                        </div>

                        <h4>5-2. êµ¬ê¸€ ì‹œíŠ¸ URL ë³µì‚¬ ë° ì„¤ì •</h4>
                        <ol>
                            <li>êµ¬ê¸€ ì‹œíŠ¸ ì—´ê¸°</li>
                            <li>ì£¼ì†Œì°½ì˜ URL ì „ì²´ ë³µì‚¬</li>
                            <li>ëŒ€ì‹œë³´ë“œ ì™¼ìª½ ìƒë‹¨ <strong>"ğŸ“Š êµ¬ê¸€ ì‹œíŠ¸ ì„¤ì •"</strong> ì¹´ë“œ ì°¾ê¸°</li>
                            <li>URL ì…ë ¥ë€ì— ë¶™ì—¬ë„£ê¸°</li>
                            <li><strong>"ğŸ”„ ì ìš©"</strong> ë²„íŠ¼ í´ë¦­</li>
                        </ol>

                        <div class="alert alert-danger">
                            <strong>ê³µìœ  ì„¤ì • í•„ìˆ˜:</strong><br>
                            êµ¬ê¸€ ì‹œíŠ¸ ê³µìœ  â†’ <strong>"ë§í¬ê°€ ìˆëŠ” ëª¨ë“  ì‚¬ìš©ì"</strong>ë¡œ ë³€ê²½ (ê¶Œí•œ: ë·°ì–´ ì´ìƒ)
                        </div>

                        <hr class="my-4">

                        <h2>ğŸ”¹ 6ë‹¨ê³„: ì‘ì—… ì„¤ì •</h2>

                        <h4>6-1. ë²”ìœ„ ì„¤ì •</h4>
                        <ul>
                            <li><strong>ì‹œì‘ ë²ˆí˜¸</strong>: ì²˜ìŒ ì¶”ê°€í•  ì¹œêµ¬ ë²ˆí˜¸ (ì˜ˆ: 1)</li>
                            <li><strong>ë ë²ˆí˜¸</strong>: ë§ˆì§€ë§‰ ì¹œêµ¬ ë²ˆí˜¸ (ì˜ˆ: 10)</li>
                        </ul>

                        <div class="alert alert-info">
                            <strong>ğŸ’¡ ì²˜ìŒ í…ŒìŠ¤íŠ¸ ì‹œ:</strong> 1~2ëª… ì •ë„ë¡œ ì‘ê²Œ ì‹œì‘í•˜ì„¸ìš”!
                        </div>

                        <h4>6-2. ëœë¤ ë”œë ˆì´ ì„¤ì •</h4>
                        <ul>
                            <li><strong>ìµœì†Œ</strong>: 5ì´ˆ</li>
                            <li><strong>ìµœëŒ€</strong>: 30ì´ˆ</li>
                        </ul>
                        <p>ê° ì¹œêµ¬ ì²˜ë¦¬ í›„ 5~30ì´ˆ ì‚¬ì´ì—ì„œ ëœë¤í•˜ê²Œ ëŒ€ê¸° (ìŠ¤íŒ¸ ì°¨ë‹¨ ë°©ì§€)</p>

                        <div class="alert alert-success">
                            <strong>ê¶Œì¥ ì„¤ì •:</strong><br>
                            ì•ˆì „ ëª¨ë“œ: ìµœì†Œ 10ì´ˆ, ìµœëŒ€ 40ì´ˆ<br>
                            ì¼ë°˜ ëª¨ë“œ: ìµœì†Œ 5ì´ˆ, ìµœëŒ€ 30ì´ˆ
                        </div>

                        <hr class="my-4">

                        <h2>ğŸ”¹ 7ë‹¨ê³„: ì‘ì—… ì‹œì‘</h2>

                        <h4>7-1. ìµœì¢… í™•ì¸ ì²´í¬ë¦¬ìŠ¤íŠ¸</h4>
                        <div class="alert alert-primary">
                            <ul class="mb-0">
                                <li>â˜‘ï¸ ì¹´ì¹´ì˜¤í†¡ ë©”ì¸ì°½ì´ í™”ë©´ì— ë³´ì´ëŠ”ê°€?</li>
                                <li>â˜‘ï¸ ì¹´í†¡ ì°½ì´ ë‹¤ë¥¸ ì°½ì— ê°€ë ¤ì§€ì§€ ì•Šì•˜ëŠ”ê°€?</li>
                                <li>â˜‘ï¸ ì¹œêµ¬ ëª©ë¡ì´ ì •ìƒì ìœ¼ë¡œ ë¡œë“œë˜ì—ˆëŠ”ê°€?</li>
                                <li>â˜‘ï¸ ë²”ìœ„ ì„¤ì •ì´ ì˜¬ë°”ë¥¸ê°€?</li>
                                <li>â˜‘ï¸ í…ŒìŠ¤íŠ¸ë¼ë©´ 1~2ëª…ìœ¼ë¡œ ì„¤ì •í–ˆëŠ”ê°€?</li>
                            </ul>
                        </div>

                        <h4>7-2. ì‹œì‘ ë²„íŠ¼ í´ë¦­</h4>
                        <p><strong>"ğŸš€ ì‹œì‘í•˜ê¸°"</strong> ë²„íŠ¼ í´ë¦­ â†’ í™•ì¸ íŒì—…ì—ì„œ "í™•ì¸" í´ë¦­</p>

                        <hr class="my-4">

                        <h2>ğŸ”¹ 8ë‹¨ê³„: ì‘ì—… ëª¨ë‹ˆí„°ë§</h2>

                        <h4>ì‘ì—… ì¤‘ ì£¼ì˜ì‚¬í•­</h4>
                        <div class="alert alert-danger">
                            <strong>âš ï¸ ì ˆëŒ€ ê¸ˆì§€:</strong>
                            <ul class="mb-0">
                                <li>âŒ ë§ˆìš°ìŠ¤ë‚˜ í‚¤ë³´ë“œ ì‚¬ìš©í•˜ì§€ ë§ ê²ƒ</li>
                                <li>âŒ ì¹´í†¡ ì°½ì„ ì˜®ê¸°ê±°ë‚˜ ìµœì†Œí™”í•˜ì§€ ë§ ê²ƒ</li>
                                <li>âŒ ë‹¤ë¥¸ ì°½ì„ ì¹´í†¡ ìœ„ì— ì˜¬ë¦¬ì§€ ë§ ê²ƒ</li>
                                <li>âŒ ì ˆì „ ëª¨ë“œë¡œ ë“¤ì–´ê°€ì§€ ì•Šë„ë¡ ì„¤ì •</li>
                            </ul>
                        </div>

                        <div class="alert alert-success">
                            <strong>âœ… ê°€ëŠ¥:</strong>
                            <ul class="mb-0">
                                <li>âœ… ëŒ€ì‹œë³´ë“œ í™”ë©´ ë³´ê¸° (ì½ê¸°ë§Œ)</li>
                                <li>âœ… ë‹¤ë¥¸ ëª¨ë‹ˆí„° ì‚¬ìš© (ì¹´í†¡ í™”ë©´ ê±´ë“œë¦¬ì§€ ì•Šê¸°)</li>
                            </ul>
                        </div>

                        <h4>ì¤‘ë‹¨ì´ í•„ìš”í•œ ê²½ìš°</h4>
                        <p><strong>"â¹ï¸ ì¤‘ë‹¨í•˜ê¸°"</strong> ë²„íŠ¼ í´ë¦­ (í˜„ì¬ ì‘ì—… ì™„ë£Œ í›„ ì¤‘ë‹¨ë¨)</p>

                        <hr class="my-4">

                        <h2>ğŸ”¹ ìì£¼ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜ ë° í•´ê²°ì±…</h2>

                        <h4>ì˜¤ë¥˜ 1: "ì¹´ì¹´ì˜¤í†¡ ì°½ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"</h4>
                        <p><strong>í•´ê²°:</strong></p>
                        <ul>
                            <li>ì¹´ì¹´ì˜¤í†¡ ì‹¤í–‰ í™•ì¸</li>
                            <li>ë©”ì¸ ì¹œêµ¬ ëª©ë¡ ì°½ì¸ì§€ í™•ì¸ (ì±„íŒ…ì°½ ì•„ë‹˜)</li>
                            <li>ì¹´í†¡ì„ ì™„ì „íˆ ì¢…ë£Œ í›„ ì¬ì‹¤í–‰</li>
                        </ul>

                        <h4>ì˜¤ë¥˜ 2: "ì°½ í™œì„±í™” ì‹¤íŒ¨"</h4>
                        <p><strong>í•´ê²°:</strong></p>
                        <ul>
                            <li>ì¹´í†¡ ì°½ì„ í™”ë©´ ì¤‘ì•™ì— ë°°ì¹˜</li>
                            <li>ìµœëŒ€í™” í•˜ì§€ ë§ê³  ë³´í†µ í¬ê¸°ë¡œ</li>
                            <li>ë‹¤ë¥¸ ì°½ ëª¨ë‘ ë‹«ê¸°</li>
                        </ul>

                        <h4>ì˜¤ë¥˜ 3: ì¹œêµ¬ ì¶”ê°€ê°€ ì‹¤íŒ¨í•¨</h4>
                        <p><strong>í•´ê²°:</strong></p>
                        <ul>
                            <li>êµ¬ê¸€ ì‹œíŠ¸ì—ì„œ ì „í™”ë²ˆí˜¸ í˜•ì‹ í™•ì¸ (01012345678)</li>
                            <li>ì´ë¯¸ ì¹œêµ¬ì¸ ê²½ìš° ìŠ¤í‚µë¨ (ì •ìƒ ë™ì‘)</li>
                            <li>ì¹´í†¡ ìµœì‹  ë²„ì „ìœ¼ë¡œ ì—…ë°ì´íŠ¸</li>
                        </ul>

                        <h4>ì˜¤ë¥˜ 4: ì„œë²„ê°€ ê°‘ìê¸° ì¤‘ë‹¨ë¨</h4>
                        <p><strong>í•´ê²°:</strong></p>
                        <ul>
                            <li>CMD ì°½ì—ì„œ ì˜¤ë¥˜ ë©”ì‹œì§€ í™•ì¸</li>
                            <li><code>python app.py</code> ë‹¤ì‹œ ì‹¤í–‰</li>
                        </ul>

                        <hr class="my-4">

                        <h2>ğŸ’¡ Pro Tips</h2>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-primary text-white">
                                        <strong>íš¨ìœ¨ì ì¸ ì¼ì • ê´€ë¦¬</strong>
                                    </div>
                                    <div class="card-body">
                                        <ul class="mb-0">
                                            <li>ì˜¤ì „: 1~50ë²ˆ (50ëª…)</li>
                                            <li>ì ì‹¬: ì„œë²„ ì¼œë‘” ì±„ë¡œ íœ´ì‹</li>
                                            <li>ì˜¤í›„: 51~100ë²ˆ (50ëª…)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-success text-white">
                                        <strong>ì•ˆì „í•œ ì‚¬ìš©</strong>
                                    </div>
                                    <div class="card-body">
                                        <ul class="mb-0">
                                            <li>í•˜ë£¨ 100ëª… ì´ìƒì€ ê¶Œì¥í•˜ì§€ ì•ŠìŒ</li>
                                            <li>ë”œë ˆì´ë¥¼ ì¶©ë¶„íˆ ê¸¸ê²Œ ì„¤ì •</li>
                                            <li>ì¹´í†¡ ê³„ì • ì°¨ë‹¨ ë°©ì§€</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="alert alert-info mt-3">
                            <strong>ğŸ“Œ ì¼ì¼ ì‘ì—… ë£¨í‹´ (ìµìˆ™í•´ì§„ í›„):</strong><br>
                            1. ë…¸íŠ¸ë¶ ì¼œê¸° â†’ 2. ì¹´í†¡ ì‹¤í–‰ (í™”ë©´ ì¤‘ì•™) â†’ 3. CMD: <code>python app.py</code> â†’
                            4. ë¸Œë¼ìš°ì €: <code>http://localhost:5000</code> â†’ 5. ë²”ìœ„/ë”œë ˆì´ ì„¤ì • â†’ 6. ì‹œì‘!
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ë‹«ê¸°</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        let eventSource = null;

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì¹œêµ¬ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
        window.onload = function() {
            loadFriends();
            startStatusPolling();
        };

        // ì¹œêµ¬ ëª©ë¡ ë¡œë“œ
        function loadFriends() {
            fetch('/api/friends')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        const tbody = document.getElementById('friendList');
                        tbody.innerHTML = '';

                        data.friends.forEach((friend, index) => {
                            const row = document.createElement('tr');
                            const hasMessage = friend.message ? 'âœ“' : '-';
                            const messagePreview = friend.message ?
                                (friend.message.substring(0, 20) + '...') : '-';

                            row.innerHTML = `
                                <td>${index + 1}</td>
                                <td>${friend.name}</td>
                                <td>${friend.phone}</td>
                                <td><small>${messagePreview}</small></td>
                            `;
                            tbody.appendChild(row);
                        });

                        document.getElementById('totalFriends').textContent = `ì´ ${data.total}ëª…`;
                        document.getElementById('endNum').value = data.total;

                        // êµ¬ê¸€ ì‹œíŠ¸ URL í‘œì‹œ
                        if (data.sheet_url) {
                            document.getElementById('sheetUrl').value = data.sheet_url;
                        }
                    } else {
                        alert('ì¹œêµ¬ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ' + data.message);
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                });
        }

        // êµ¬ê¸€ ì‹œíŠ¸ URL ì—…ë°ì´íŠ¸
        function updateSheetUrl() {
            const url = document.getElementById('sheetUrl').value.trim();

            if (!url) {
                alert('êµ¬ê¸€ ì‹œíŠ¸ URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            fetch('/api/sheet-url', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ url: url })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('âœ“ ' + data.message);
                    refreshFriends();
                } else {
                    alert('âœ— ' + data.message);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            });
        }

        // ì¹œêµ¬ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
        function refreshFriends() {
            const tbody = document.getElementById('friendList');
            tbody.innerHTML = '<tr><td colspan="4" class="text-center">ìƒˆë¡œê³ ì¹¨ ì¤‘...</td></tr>';
            loadFriends();
        }

        // ì‘ì—… ì‹œì‘
        function startTask() {
            const start = parseInt(document.getElementById('startNum').value);
            const end = parseInt(document.getElementById('endNum').value);
            const delayMin = parseFloat(document.getElementById('delayMin').value);
            const delayMax = parseFloat(document.getElementById('delayMax').value);

            if (start < 1 || end < start) {
                alert('ì˜¬ë°”ë¥¸ ë²”ìœ„ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (delayMin < 0 || delayMax < delayMin) {
                alert('ì˜¬ë°”ë¥¸ ë”œë ˆì´ ë²”ìœ„ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (!confirm(`${start}ë²ˆë¶€í„° ${end}ë²ˆê¹Œì§€ ${end - start + 1}ëª…ì„ ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                return;
            }

            fetch('/api/start', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    start: start,
                    end: end,
                    delay_min: delayMin,
                    delay_max: delayMax
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    document.getElementById('startBtn').style.display = 'none';
                    document.getElementById('stopBtn').style.display = 'block';
                    startLogStream();
                } else {
                    alert(data.message);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            });
        }

        // ì‘ì—… ì¤‘ë‹¨
        function stopTask() {
            if (!confirm('ì‘ì—…ì„ ì¤‘ë‹¨í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                return;
            }

            fetch('/api/stop', {
                method: 'POST'
            })
            .then(response => response.json())
            .then(data => {
                alert(data.message);
            });
        }

        // ìƒíƒœ í´ë§
        function startStatusPolling() {
            setInterval(() => {
                fetch('/api/status')
                    .then(response => response.json())
                    .then(data => {
                        // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
                        const percent = data.total > 0 ? Math.round((data.current / data.total) * 100) : 0;
                        document.getElementById('progressBar').style.width = percent + '%';
                        document.getElementById('progressPercent').textContent = percent + '%';
                        document.getElementById('progressText').textContent =
                            data.running ? `ì§„í–‰ ì¤‘: ${data.current} / ${data.total}` : 'ëŒ€ê¸° ì¤‘...';

                        // ì¹´ìš´í„° ì—…ë°ì´íŠ¸
                        document.getElementById('successCount').textContent = data.success_count;
                        document.getElementById('failCount').textContent = data.fail_count;
                        document.getElementById('totalCount').textContent = data.total;

                        // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
                        if (!data.running) {
                            document.getElementById('startBtn').style.display = 'block';
                            document.getElementById('stopBtn').style.display = 'none';
                        }
                    });
            }, 1000);
        }

        // ë¡œê·¸ ìŠ¤íŠ¸ë¦¬ë°
        function startLogStream() {
            if (eventSource) {
                eventSource.close();
            }

            eventSource = new EventSource('/api/logs/stream');
            eventSource.onmessage = function(event) {
                const log = JSON.parse(event.data);
                addLog(log);
            };
        }

        // ë¡œê·¸ ì¶”ê°€
        function addLog(log) {
            const logContainer = document.getElementById('logContainer');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.innerHTML = `<span class="log-time">[${log.time}]</span>${log.message}`;
            logContainer.appendChild(entry);
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        // ë¡œê·¸ ì§€ìš°ê¸°
        function clearLogs() {
            document.getElementById('logContainer').innerHTML = '';
        }

        // ì´ìš© ë§¤ë‰´ì–¼ ëª¨ë‹¬ ì—´ê¸°
        function showManual() {
            const manualModal = new bootstrap.Modal(document.getElementById('manualModal'));
            manualModal.show();
        }
    </script>
</body>
</html>
