# OnlyTalk Windows 클라이언트 사용 가이드 v2.0

**버전:** v2.0 (이미지 인식)
**날짜:** 2025-12-23
**작성자:** 아리 (Claude Code)

---

## 🎉 v2.0 새로운 기능

### ✨ 이미지 인식 기술
- '사람+' 아이콘을 이미지 인식으로 자동 검색
- 창 크기나 해상도에 상관없이 작동
- 다양한 화면 설정에서 안정적으로 동작

### 💪 강화된 창 관리
- Windows API를 사용한 강력한 창 활성화
- 매 작업 후 카카오톡 창을 자동으로 최상단으로 이동
- 터미널을 클릭해도 작업 중단 없음

### 🔧 향상된 안정성
- 여러 confidence 레벨로 아이콘 검색 (90%, 80%, 70%, 60%)
- 아이콘을 찾지 못하면 자동으로 기본 좌표 사용
- 에러 발생 시에도 창 관리 유지

---

## 📦 설치 및 실행

### 1. 필수 프로그램
- Python 3.10 이상
- 카카오톡 (Windows용)

### 2. 필요한 패키지 설치
```bash
pip install requests flask flask-cors pyautogui pyperclip pygetwindow pywin32 opencv-python
```

**v2.0 추가 패키지:**
- opencv-python (이미지 인식)

### 3. 실행 방법

#### 방법 1: Python 스크립트 실행
```bash
python client_main.py
```

#### 방법 2: 실행 파일 (.exe) 사용
- OnlyTalk.exe 더블클릭

---

## 🔑 라이선스 등록

1. https://only-talk.kiam.kr 접속
2. 회원가입 및 로그인
3. 요금제 선택 후 결제
4. 대시보드에서 라이선스 키 확인
5. 클라이언트 실행 시 라이선스 키 입력

---

## 📊 데이터 준비

### 옵션 1: 로컬 CSV 파일
파일명: `kakao_friends.csv`

형식:
```csv
이름,전화번호,메시지
홍길동,010-1234-5678,안녕하세요
김철수,010-9876-5432,반갑습니다
```

### 옵션 2: 구글 시트 연동
1. 구글 시트 생성
2. 위와 동일한 형식으로 데이터 입력
3. 파일 → 공유 → "링크가 있는 모든 사용자" 설정
4. 공유 링크 복사
5. 클라이언트 실행 시 구글 시트 URL 입력

---

## 🚀 사용 방법

1. **클라이언트 실행**
   - `python client_main.py` 실행
   - 라이선스 키 입력 (최초 1회)

2. **구글 시트 설정 (선택사항)**
   - 구글 시트 URL 입력
   - 자동으로 CSV 다운로드

3. **웹 대시보드 접속**
   - 자동으로 브라우저 실행
   - http://localhost:5000 접속

4. **카카오톡 친구 추가 시작**
   - 친구 범위 설정 (예: 1~50)
   - 딜레이 시간 설정 (예: 1.5~2.0초)
   - "시작" 버튼 클릭

**v2.0 특징:**
- 자동으로 '사람+' 아이콘 위치 검색
- 검색 결과가 로그에 표시됨
- 창 크기를 변경해도 정상 작동

---

## ⚙️ 설정 파일

`onlytalk_config.json` - 자동 생성됨
```json
{
  "license_key": "OT-xxxxx...",
  "device_id": "COMPUTER-MAC",
  "google_sheet_url": "https://docs.google.com/..."
}
```

---

## 🎨 person_plus_icon.png (v2.0 신규)

클라이언트 폴더에 포함된 40x42 픽셀 이미지
- 카카오톡 '사람+' 아이콘의 스크린샷
- 이미지 인식에 사용됨
- 파일이 없어도 기본 좌표로 작동

---

## ⚠️ 주의사항

1. **카카오톡 창 배치**
   - 카카오톡을 화면에 보이도록 배치
   - 다른 창에 가려지지 않도록 주의
   - **v2.0: 창 크기는 상관없음!**

2. **작업 중 주의**
   - 작업 중에는 마우스/키보드 사용 금지
   - 작업이 끝날 때까지 대기
   - **v2.0: 터미널 클릭해도 자동으로 창 복원**

3. **계정 제한 방지**
   - 하루 100~200명 이하 추가 권장
   - 딜레이 시간 1.5초 이상 권장
   - 분산해서 작업 (여러 날에 걸쳐)

4. **라이선스 관리**
   - 1개 라이선스 = 1대 PC
   - 다른 PC 사용 시 새 라이선스 필요

---

## 🐛 문제 해결

### 라이선스 인증 실패
- 인터넷 연결 확인
- 라이선스 키 정확히 입력 확인
- 만료일 확인

### 카카오톡 창을 찾을 수 없음
- 카카오톡 실행 확인
- 카카오톡 창을 화면에 배치

### 구글 시트 다운로드 실패
- 공유 설정 확인 ("링크가 있는 모든 사용자")
- URL 정확히 입력 확인

### v2.0 이미지 인식 실패 (신규)
- person_plus_icon.png 파일 확인
- 파일이 없어도 기본 좌표로 작동
- 로그에서 "아이콘 발견" 메시지 확인

---

## 📞 고객 지원

- 웹사이트: https://only-talk.kiam.kr
- 이메일: support@only-talk.kiam.kr
- 운영시간: 평일 09:00~18:00

---

## 📝 업데이트 히스토리

### v2.0 (2025-12-23) - 현재 버전
- ✅ 이미지 인식으로 '사람+' 아이콘 자동 검색
- ✅ 창 활성화 강화 (Windows API 사용)
- ✅ 매 작업 후 창 최상단 이동
- ✅ opencv-python 패키지 추가
- ✅ person_plus_icon.png 포함
- ✅ 다양한 해상도/창 크기 지원

### v1.0 (2025-12-20)
- 서버 연동 라이선스 검증
- 구글 시트 연동
- 웹 대시보드 인터페이스
- 기본 친구 추가 + 메시지 전송

---

**작성자:** 아리 (Claude Code)
**최종 업데이트:** 2025-12-23
**버전:** v2.0
